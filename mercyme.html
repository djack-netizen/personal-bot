<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Loading...</title>
<link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.7/dist/chart.umd.min.js"></script>
<style>
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
:root{--bg:#0a0a1a;--card:rgba(255,255,255,0.04);--border:rgba(255,255,255,0.08);--text:#e4e4e7;--muted:#a1a1aa;--grad:linear-gradient(135deg,#6366f1,#3b82f6);--grad2:linear-gradient(135deg,#6366f1,#3b82f6,#00d4ff);--green:#22c55e;--red:#ef4444;--yellow:#eab308;--radius:16px;--pill:999px}
body{font-family:'Plus Jakarta Sans',Inter,system-ui,sans-serif;background:var(--bg);color:var(--text);line-height:1.5;min-height:100vh}
.fade-in{animation:fadeIn .5s ease}
@keyframes fadeIn{from{opacity:0;transform:translateY(8px)}to{opacity:1;transform:translateY(0)}}
.container{max-width:1200px;margin:0 auto;padding:32px 24px}
.title-area{margin-bottom:36px;text-align:center}
.title-area h1{font-size:clamp(1.5rem,4vw,2.2rem);font-weight:800;letter-spacing:-.03em;margin-bottom:4px}
.title-area .powered{color:var(--muted);font-size:.88rem;margin-bottom:14px}
.social-pills{display:flex;gap:10px;justify-content:center;margin-bottom:12px;flex-wrap:wrap}
.social-pill{display:inline-flex;align-items:center;gap:6px;border-radius:var(--pill);padding:5px 14px;font-size:.78rem;font-weight:600;border:1px solid transparent;background-origin:border-box;background-clip:padding-box,border-box;background-image:linear-gradient(var(--bg),var(--bg)),var(--grad2);color:var(--text);text-decoration:none;transition:all .25s}
.social-pill:hover{box-shadow:0 0 12px rgba(99,102,241,.3);transform:translateY(-1px)}
.social-pill svg{width:14px;height:14px;fill:currentColor}
.period-badge{display:inline-block;border-radius:var(--pill);padding:4px 14px;font-size:.75rem;color:var(--muted);border:1px solid var(--border);background:var(--card)}
.date-pills{display:flex;gap:8px}
.date-pill{border-radius:var(--pill);padding:6px 18px;font-size:.82rem;font-weight:600;cursor:pointer;border:1px solid var(--border);background:transparent;color:var(--muted);transition:all .25s}
.date-pill:hover{border-color:rgba(99,102,241,.4);color:var(--text)}
.date-pill.active{background:var(--grad);border-color:transparent;color:#fff;box-shadow:0 0 16px rgba(99,102,241,.35)}
.kpi-row{display:grid;grid-template-columns:repeat(5,1fr);gap:16px;margin-bottom:36px}
.kpi-card{background:var(--card);border:1px solid var(--border);border-radius:var(--radius);backdrop-filter:blur(10px);padding:22px 20px;transition:all .3s;position:relative;overflow:hidden}
.kpi-card::before{content:'';position:absolute;inset:0;border-radius:var(--radius);opacity:0;transition:opacity .3s;background:linear-gradient(135deg,rgba(99,102,241,.08),rgba(59,130,246,.06))}
.kpi-card:hover{transform:translateY(-3px);border-color:rgba(99,102,241,.25);box-shadow:0 8px 32px rgba(99,102,241,.12)}
.kpi-card:hover::before{opacity:1}
.kpi-label{font-size:.75rem;color:var(--muted);text-transform:uppercase;letter-spacing:.06em;font-weight:600;margin-bottom:8px}
.kpi-value{font-size:1.55rem;font-weight:800;letter-spacing:-.02em;margin-bottom:2px}
.section-title{font-size:1.15rem;font-weight:700;margin-bottom:16px}
.table-wrap{background:var(--card);border:1px solid var(--border);border-radius:var(--radius);backdrop-filter:blur(10px);overflow-x:auto;margin-bottom:36px}
table{width:100%;border-collapse:collapse;min-width:700px}
th{text-align:left;padding:14px 16px;font-size:.7rem;color:var(--muted);text-transform:uppercase;letter-spacing:.08em;font-weight:600;border-bottom:1px solid var(--border)}
td{padding:14px 16px;font-size:.88rem;border-bottom:1px solid rgba(255,255,255,0.03)}
tr:last-child td{border-bottom:none}
tr:hover td{background:rgba(255,255,255,0.02)}
.pill{display:inline-flex;align-items:center;border-radius:var(--pill);padding:3px 12px;font-size:.73rem;font-weight:600}
.pill-active{background:linear-gradient(135deg,#22c55e,#16a34a);color:#fff}
.pill-paused{background:rgba(234,179,8,.15);color:#eab308}
.chart-grid-row{display:grid;grid-template-columns:1fr 1fr;gap:24px;margin-bottom:36px}
.chart-area{background:var(--card);border:1px solid var(--border);border-radius:var(--radius);backdrop-filter:blur(10px);padding:24px;position:relative}
.chart-title{font-size:1rem;font-weight:700;margin-bottom:16px}
.chart-canvas-wrap{position:relative;width:100%;height:0;padding-bottom:38%}
.chart-canvas-wrap canvas{position:absolute;top:0;left:0;width:100%!important;height:100%!important}
.footer{text-align:center;padding:24px;color:var(--muted);font-size:.8rem;border-top:1px solid var(--border)}
.footer strong{color:var(--text);font-weight:700}
.data-container{transition:opacity .3s}
.data-container.switching{opacity:0}
.view-link{display:inline-flex;align-items:center;gap:4px;color:#818cf8;font-size:.78rem;font-weight:600;text-decoration:none;transition:all .2s;white-space:nowrap}
.view-link:hover{color:#a5b4fc;text-decoration:underline}
.view-link svg{width:12px;height:12px;fill:currentColor}
.loading{text-align:center;padding:60px;color:var(--muted);font-size:.9rem}
@media(max-width:900px){.kpi-row{grid-template-columns:repeat(3,1fr)}.chart-grid-row{grid-template-columns:1fr}}
@media(max-width:600px){.kpi-row{grid-template-columns:1fr 1fr}.container{padding:20px 14px}.title-area h1{font-size:1.4rem}.chart-canvas-wrap{padding-bottom:50%}}
@media print{body{background:#fff;color:#111}.kpi-card,.table-wrap,.chart-area{background:#f8f8f8;border:1px solid #ddd;backdrop-filter:none;color:#111}.kpi-value,.section-title,.chart-title{color:#111}.kpi-label,.footer{color:#555}}
</style>
</head>
<body>
<div class="container">
  <div class="title-area fade-in">
    <h1 id="dashTitle">Loading...</h1>
    <div class="powered">Powered by <strong>OPN Agency</strong></div>
    <div class="social-pills" id="socialPills"></div>
    <div style="display:flex;align-items:center;gap:10px;flex-wrap:wrap;margin-top:4px;justify-content:center">
      <div class="period-badge" id="periodBadge">Loading...</div>
      <div class="date-pills">
        <div class="date-pill active" onclick="setRange(7)">7 Days</div>
        <div class="date-pill" onclick="setRange(30)">30 Days</div>
      </div>
    </div>
  </div>
  <div class="data-container" id="dataContainer">
    <div class="loading" id="loadingMsg">Loading dashboard data...</div>
    <div class="kpi-row fade-in" id="kpiRow"></div>
    <div class="section-title fade-in" id="campaignTitle" style="display:none">Campaign Breakdown</div>
    <div class="table-wrap fade-in" id="tableWrap" style="display:none">
      <table><thead><tr><th>Campaign</th><th>Status</th><th>Spend</th><th>Impressions</th><th>Reach</th><th>Clicks</th><th>CTR</th><th>CPC</th><th>Video Views</th><th>LP Views</th><th>Ad Link</th></tr></thead>
        <tbody id="campaignBody"></tbody></table>
    </div>
    <div class="chart-grid-row fade-in" id="chartRow" style="display:none">
      <div class="chart-area"><div class="chart-title">Daily Ad Spend</div><div class="chart-canvas-wrap"><canvas id="spendChart"></canvas></div></div>
      <div class="chart-area"><div class="chart-title">Impressions vs Clicks</div><div class="chart-canvas-wrap"><canvas id="impClickChart"></canvas></div></div>
    </div>
  </div>
</div>
<div class="footer">Dashboard generated by <strong>OPN Agency</strong> &#183; Data from Meta Ads API &#183; Last updated: <span id="lastUpdated">...</span></div>
<script>
var CLIENT='mercyme';
var SOCIAL_ICONS={facebook:'<svg viewBox="0 0 24 24"><path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/></svg>',instagram:'<svg viewBox="0 0 24 24"><path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zM12 0C8.741 0 8.333.014 7.053.072 2.695.272.273 2.69.073 7.052.014 8.333 0 8.741 0 12c0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98C8.333 23.986 8.741 24 12 24c3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98C15.668.014 15.259 0 12 0zm0 5.838a6.162 6.162 0 100 12.324 6.162 6.162 0 000-12.324zM12 16a4 4 0 110-8 4 4 0 010 8zm6.406-11.845a1.44 1.44 0 100 2.881 1.44 1.44 0 000-2.881z"/></svg>'};
var CFG,DATA,ADS_MGR,currentRange=7,spendChart,impClickChart;
function fmt(n){return n.toLocaleString('en-US')}
function money(n){return '$'+n.toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g,',')}
function pct(n){return n.toFixed(2)+'%'}
function sumF(a,f){var t=0;for(var i=0;i<a.length;i++)t+=(a[i][f]||0);return t}
function campRange(camp,days){var slice=DATA.daily.slice(-days);if(!slice.length)return null;var ds={};for(var i=0;i<slice.length;i++)ds[slice[i].d]=true;var rows=[];for(var j=0;j<camp.daily.length;j++){if(ds[camp.daily[j].d])rows.push(camp.daily[j])}var ts=sumF(rows,'spend');if(ts<0.01)return null;var ti=sumF(rows,'imp'),tc=sumF(rows,'clicks'),tr=sumF(rows,'reach'),tv=sumF(rows,'video'),tl=sumF(rows,'lp');return{name:camp.name,id:camp.id,status:camp.status,spend:ts,imp:ti,clicks:tc,reach:tr,video:tv,lp:tl,ctr:ti>0?(tc/ti*100):0,cpc:tc>0?(ts/tc):0}}
function setRange(r){if(r===currentRange)return;currentRange=r;document.querySelectorAll('.date-pill').forEach(function(p){p.classList.toggle('active',parseInt(p.textContent)===r)});var dc=document.getElementById('dataContainer');dc.classList.add('switching');setTimeout(function(){render(r);dc.classList.remove('switching')},300)}
function render(r){if(!DATA)return;var slice=DATA.daily.slice(-r);document.getElementById('periodBadge').textContent=slice[0].d+' \u2013 '+slice[slice.length-1].d;var ts=sumF(slice,'spend'),ti=sumF(slice,'imp'),tc=sumF(slice,'clicks'),tr=sumF(slice,'reach'),tv=sumF(slice,'video'),tl=sumF(slice,'lp'),tsa=sumF(slice,'saves'),tre=sumF(slice,'reactions');var kpis=[{l:'Total Spend',v:money(ts)},{l:'Impressions',v:fmt(ti)},{l:'Reach',v:fmt(tr)},{l:'Clicks',v:fmt(tc)},{l:'CTR',v:pct(ti>0?tc/ti*100:0)},{l:'CPC',v:money(tc>0?ts/tc:0)},{l:'Video Views',v:fmt(tv)},{l:'Landing Page Views',v:fmt(tl)},{l:'Post Saves',v:fmt(tsa)},{l:'Post Reactions',v:fmt(tre)}];var kh='';for(var i=0;i<kpis.length;i++)kh+='<div class="kpi-card"><div class="kpi-label">'+kpis[i].l+'</div><div class="kpi-value">'+kpis[i].v+'</div></div>';document.getElementById('kpiRow').innerHTML=kh;var camps=[];for(var c=0;c<DATA.campaigns.length;c++){var cr=campRange(DATA.campaigns[c],r);if(cr)camps.push(cr)}camps.sort(function(a,b){return b.spend-a.spend});var h='';for(var x=0;x<camps.length;x++){var cp=camps[x],sp=cp.status==='Active'?'pill-active':'pill-paused',al=ADS_MGR+'&selected_campaign_ids='+cp.id;h+='<tr><td style="font-weight:600">'+cp.name+'</td><td><span class="pill '+sp+'">'+cp.status+'</span></td><td>'+money(cp.spend)+'</td><td>'+fmt(cp.imp)+'</td><td>'+(cp.reach?fmt(cp.reach):'\u2014')+'</td><td>'+fmt(cp.clicks)+'</td><td>'+pct(cp.ctr)+'</td><td>'+money(cp.cpc)+'</td><td>'+(cp.video?fmt(cp.video):'\u2014')+'</td><td>'+(cp.lp?fmt(cp.lp):'\u2014')+'</td><td><a href="'+al+'" target="_blank" class="view-link"><svg viewBox="0 0 24 24"><path d="M14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3h-7z"/><path d="M5 5v14h14v-7h2v7c0 1.1-.9 2-2 2H5c-1.1 0-2-.9-2-2V5c0-1.1.9-2 2-2h7v2H5z"/></svg>View</a></td></tr>'}document.getElementById('campaignBody').innerHTML=h;var lb=[],sd=[],id=[],cd=[];for(var j=0;j<slice.length;j++){lb.push(slice[j].d);sd.push(slice[j].spend);id.push(slice[j].imp);cd.push(slice[j].clicks)}if(spendChart)spendChart.destroy();if(impClickChart)impClickChart.destroy();var gc='rgba(255,255,255,0.06)',tkc='#a1a1aa';spendChart=new Chart(document.getElementById('spendChart'),{type:'bar',data:{labels:lb,datasets:[{label:'Spend ($)',data:sd,backgroundColor:'rgba(99,102,241,0.7)',borderRadius:4,borderSkipped:false}]},options:{responsive:true,maintainAspectRatio:false,plugins:{legend:{display:false}},scales:{x:{ticks:{color:tkc,font:{size:10},maxRotation:45},grid:{display:false}},y:{ticks:{color:tkc,callback:function(v){return '$'+v}},grid:{color:gc}}}}});impClickChart=new Chart(document.getElementById('impClickChart'),{type:'line',data:{labels:lb,datasets:[{label:'Impressions',data:id,borderColor:'#6366f1',backgroundColor:'rgba(99,102,241,0.1)',fill:true,tension:.3,yAxisID:'y',pointRadius:2},{label:'Clicks',data:cd,borderColor:'#22c55e',backgroundColor:'rgba(34,197,94,0.1)',fill:true,tension:.3,yAxisID:'y1',pointRadius:2}]},options:{responsive:true,maintainAspectRatio:false,interaction:{mode:'index',intersect:false},plugins:{legend:{labels:{color:tkc,font:{size:11}}}},scales:{x:{ticks:{color:tkc,font:{size:10},maxRotation:45},grid:{display:false}},y:{type:'linear',position:'left',ticks:{color:'#6366f1',callback:function(v){return fmt(v)}},grid:{color:gc},title:{display:true,text:'Impressions',color:'#6366f1',font:{size:11}}},y1:{type:'linear',position:'right',ticks:{color:'#22c55e'},grid:{drawOnChartArea:false},title:{display:true,text:'Clicks',color:'#22c55e',font:{size:11}}}}}})}
Promise.all([fetch(CLIENT+'-config.json?t='+Date.now()).then(function(r){return r.json()}),fetch(CLIENT+'-data.json?t='+Date.now()).then(function(r){return r.json()})]).then(function(res){CFG=res[0];DATA=res[1];ADS_MGR='https://adsmanager.facebook.com/adsmanager/manage/campaigns?act='+CFG.adAccount;document.title=CFG.name+' \u2014 '+CFG.tagline;document.getElementById('dashTitle').innerHTML=CFG.name+' &#8212; '+CFG.tagline;document.getElementById('lastUpdated').textContent=DATA.lastUpdated;var sh='';for(var s=0;s<CFG.socials.length;s++){var sc=CFG.socials[s],ic=SOCIAL_ICONS[sc.platform]||'',lb=sc.platform.charAt(0).toUpperCase()+sc.platform.slice(1);sh+='<a href="'+sc.url+'" target="_blank" class="social-pill">'+ic+lb+'</a>'}sh+='<a href="'+ADS_MGR+'" target="_blank" class="social-pill"><svg viewBox="0 0 24 24"><path d="M12 0C5.373 0 0 5.373 0 12s5.373 12 12 12 12-5.373 12-12S18.627 0 12 0zm1 17h-2v-6h2v6zm0-8h-2V7h2v2z"/></svg>Ads Manager</a>';document.getElementById('socialPills').innerHTML=sh;document.getElementById('loadingMsg').style.display='none';document.getElementById('campaignTitle').style.display='';document.getElementById('tableWrap').style.display='';document.getElementById('chartRow').style.display='';render(7)}).catch(function(e){document.getElementById('loadingMsg').textContent='Error loading data: '+e.message});
</script>
</body>
</html>
